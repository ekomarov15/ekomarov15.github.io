<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–û–ì–≠ –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É ‚Äî –≠–∫–∑–∞–º–µ–Ω</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --blue:#2563eb;
  --blue-dark:#1e40af;
  --bg:#eef4ff;
  --card:#ffffff;
  --text:#1f2937;
  --muted:#64748b;
}

body{
  margin:0;
  font-family:Inter,sans-serif;
  background:var(--bg);
  color:var(--text);
}

.wrap{
  max-width:960px;
  margin:auto;
  padding:24px 20px 60px;
}

.header{
  background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  color:white;
  padding:26px;
  border-radius:22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.timer{
  font-size:20px;
  font-weight:700;
}

*{
  box-sizing:border-box;
  max-width:100%;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–¥–∞–Ω–∏—è */
.task{
  overflow:hidden;
}

/* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ç–µ–∫—Å—Ç */
.task h2,
.task p,
.option,
label{
  word-break: break-word;
  overflow-wrap: anywhere;
  white-space: normal;
}

/* –û–ø—Ü–∏–∏ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ */
.option{
  display:flex;
  align-items:flex-start;
  gap:12px;
  max-width:100%;
  min-width:0;
}

/* –¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ option */
.option span{
  flex:1;
  min-width:0;
}

/* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
input[type="text"],
textarea{
  max-width:100%;
  overflow-wrap: break-word;
  word-break: break-word;
}

/* –†–∞–¥–∏–æ / —á–µ–∫–±–æ–∫—Å—ã –Ω–µ —Å–∂–∏–º–∞—é—Ç—Å—è */
input[type="checkbox"]{
  flex-shrink:0;
  margin-top:3px;
}

input[type="text"], textarea{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid #c7d2fe;
  font-size:16px;
  font-family:Inter,sans-serif;
}

textarea{
  min-height:140px;
}

button{
  margin-top:30px;
  padding:16px 26px;
  border:none;
  border-radius:16px;
  background:var(--blue);
  color:white;
  font-size:18px;
  font-weight:600;
  cursor:pointer;
}

button:hover{
  background:var(--blue-dark);
}
</style>
</head>

<body>
<div class="wrap">

  <div class="header">
    <h1>üìù –ü—Ä–æ–±–Ω—ã–π –û–ì–≠ –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É</h1>
    <div class="timer" id="timer">03:55:00</div>
  </div>

  <div id="exam"></div>

  <button onclick="finishExam()">–ó–∞–≤–µ—Ä—à–∏—Ç—å —ç–∫–∑–∞–º–µ–Ω</button>

</div>

<script type="module">
import { generateVariant } from "./generator.js";

const examEl = document.getElementById("exam");
const timerEl = document.getElementById("timer");

const variant = generateVariant();
let answers = {};

// ===== –¢–ê–ô–ú–ï–† =====
let timeLeft = 3 * 3600 + 55 * 60;
setInterval(() => {
  timeLeft--;
  const h = String(Math.floor(timeLeft / 3600)).padStart(2,'0');
  const m = String(Math.floor(timeLeft % 3600 / 60)).padStart(2,'0');
  const s = String(timeLeft % 60).padStart(2,'0');
  timerEl.textContent = `${h}:${m}:${s}`;
  if(timeLeft <= 0) finishExam();
}, 1000);

// ===== –°–û–•–†–ê–ù–ï–ù–ò–ï –û–¢–í–ï–¢–ê =====
window.saveAnswer = (num, value) => {
  answers[num] = value;
};

// ===== –û–ë–†–ê–ë–û–¢–ö–ê –ß–ï–ö–ë–û–ö–°–û–í =====
window.handleCheckbox = (num) => {
  const checked = [...document.querySelectorAll(`input[name="q${num}"]:checked`)]
    .map(el => el.value)
    .sort()
    .join("");
  saveAnswer(num, checked);
};

// ===== –û–¢–†–ò–°–û–í–ö–ê =====
variant.forEach(task => {

  // 1 ‚Äî –∏–∑–ª–æ–∂–µ–Ω–∏–µ
  if(task.number === 1){
    examEl.innerHTML += `
    <div class="task">
      <h2>1Ô∏è‚É£ –ò–∑–ª–æ–∂–µ–Ω–∏–µ</h2>
      <textarea oninput="saveAnswer(1,this.value)"></textarea>
    </div>`;
  }

  // –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ô –í–´–ë–û–†
  else if([2,3,6,10,11].includes(task.number)){
    examEl.innerHTML += `
    <div class="task">
      <h2>–ó–∞–¥–∞–Ω–∏–µ ${task.number}</h2>
      ${task.data.options.map((opt,i)=>`
        <label class="option">
          <input type="checkbox"
            name="q${task.number}"
            value="${i+1}"
            onchange="handleCheckbox(${task.number})">
          ${opt}
        </label>
      `).join("")}
    </div>`;
  }

  // –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –¶–ò–§–†
  else if([4,5,7].includes(task.number)){
    examEl.innerHTML += `
    <div class="task">
      <h2>–ó–∞–¥–∞–Ω–∏–µ ${task.number}</h2>
      <input type="text"
        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 235"
        oninput="saveAnswer(${task.number},this.value)">
    </div>`;
  }

  // –°–õ–û–í–û / –°–õ–û–í–û–°–û–ß–ï–¢–ê–ù–ò–ï
  else if([8,9,12].includes(task.number)){
    examEl.innerHTML += `
    <div class="task">
      <h2>–ó–∞–¥–∞–Ω–∏–µ ${task.number}</h2>
      <input type="text"
        placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç"
        oninput="saveAnswer(${task.number},this.value.trim().toLowerCase())">
    </div>`;
  }

  // 13 ‚Äî —Å–æ—á–∏–Ω–µ–Ω–∏–µ
  else if(task.number === 13){
    examEl.innerHTML += `
    <div class="task">
      <h2>‚úçÔ∏è –°–æ—á–∏–Ω–µ–Ω–∏–µ (–∑–∞–¥–∞–Ω–∏–µ 13)</h2>
      <p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –§–ò–ü–ò:</strong> —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ, –ª–æ–≥–∏–∫–∞, –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—è, —Ä–µ—á—å, –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å</p>
      <textarea oninput="saveAnswer(13,this.value)"></textarea>
    </div>`;
  }
});

// ===== –ó–ê–í–ï–†–®–ï–ù–ò–ï =====
window.finishExam = () => {
  localStorage.setItem("oge_result", JSON.stringify({ variant, answers }));
  location.href = "results.html";
};
</script>

</body>
</html>
